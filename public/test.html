<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Run Tests</title>
  <link rel="stylesheet" href="/js/mocha.css" />
  <script src="/js/mocha.js"></script>
  <script src="/js/chai.js"></script>
  <script src="/js/superagent.js"></script>
</head>
<body>
  <h1>Run Tests</h1>
  <button onclick="runTests()">Run Tests</button>
  <div id="mocha"></div>

  <script>
    mocha.setup('bdd');
    const { expect } = chai;
    const request = superagent;

    describe('API Tests', function() {
      it('should register a new user', async function() {
        const res = await request.post('/register').send({
          username: 'testuser',
          password: 'testpassword'
        });
        expect(res.status).to.equal(200);
        expect(res.body).to.have.property('id');
      });

      it('should log in a user', async function() {
        const res = await request.post('/login').send({
          username: 'testuser',
          password: 'testpassword'
        });
        expect(res.status).to.equal(200);
        expect(res.body).to.have.property('id');
      });

      it('should submit a question', async function() {
        const res = await request.post('/submit_question').send({
          question: 'What is the capital of France?',
          type: 'text',
          category: 'geography',
          answer: 'Paris',
          creator: 'testuser'
        });
        expect(res.status).to.equal(200);
        expect(res.body).to.have.property('id');
      });
    });

    function runTests() {
      mocha.run();
    }
  </script>
</body>
</html>
